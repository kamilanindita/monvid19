<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Favicons -->
  <link rel="icon" type="image/png" href="/images/icon.png">

  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/footer.css">
  <link rel="stylesheet" href="/css/timeline.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <title>Monvid-19</title>
  <style>
  .highcharts-figure, .highcharts-data-table table {
    min-width: 270px;
    max-width: 1200px;
    margin: 1em auto;
  }

  .highcharts-data-table table {
  	font-family: Verdana, sans-serif;
  	border-collapse: collapse;
  	border: 1px solid #EBEBEB;
  	margin: 10px auto;
  	text-align: center;
  	width: 100%;
  	max-width: 500px;
  }
  .highcharts-data-table caption {
      padding: 1em 0;
      font-size: 1.2em;
      color: #555;
  }
  .highcharts-data-table th {
  	font-weight: 600;
      padding: 0.5em;
  }
  .highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
      padding: 0.5em;
  }
  .highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
      background: #f8f8f8;
  }
  .highcharts-data-table tr:hover {
      background: #f1f7ff;
  }

  </style>
</head>
<body>
<header>
    <img class="mx-auto d-block mt-2" src="/images/logo.png" alt="logo"></a>
    <nav class="navbar fixed-bottom navbar-expand navbar-light bg-white">
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav mx-auto text-center">
          <a class="nav-item nav-link" href="index.html">
            <i class="fa fa-home fa-2x"></i><br>
            <small style="font-size:10px;" class="text-muted">Home</small>
          </a>
          <a class="nav-item nav-link" href="details_global.html">
            <i class="fa fa-globe fa-2x"></i><br>
            <small style="font-size:10px;" class="text-muted">Global</small></a>
          <a class="nav-item nav-link active" href="details_indonesia.html">
            <i class="fa fa-list-alt fa-2x"></i><br>
            <small style="font-size:10px;">Indonesia</small></a>
          <a class="nav-item nav-link" href="about.html">
            <i class="fa fa-info-circle fa-2x"></i><br>
            <small style="font-size:10px;" class="text-muted">About</small></a>
        </div>
      </div>
    </nav>
</header>


<div style="margin-top:10px;" class="container-fluid">
    <div class="row">
      <div class="col-sm-12">
        <div class="card text-white">
          <img class="card-img-top" src="/images/indo.jpg" style="opacity:1;min-height:294px" alt="indonesia">
          <div class="card-img-overlay">
            <h4 class="card-title text-center">Indonesi</h4>
            <br>
            <div id="indonesia" class="card-text">Loading...</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<br>
<div class="container">
  <div class="container-fluid">
    <h4>Highest Cases</h4>
    <div class="row">
      <div class="col-sm-4">
        <div class="card text-white">
          <div class="card-body bg-danger">
            <h4 class="card-title text-center">Confirmed</h4>
            <div id="confirmed" class="card-text">Loading...</div>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="card text-white">
          <div class="card-body bg-dark">
            <h4 class="card-title text-center">Deaths</h4>
            <div id="meninggal" class="card-text">Loading...</div>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
          <div class="card text-white">
            <div class="card-body bg-success">
              <h4 class="card-title text-center">Recovered</h4>
              <div id="sembuh" class="card-text">Loading...</div>
            </div>
          </div>
      </div>
    </div>
  </div>
</div>
<br>
<div class="container">
  <div class="container-fluid">
    <figure class="highcharts-figure">
        <div id="container"></div>
    </figure>
  </div>
</div>
<br>
<div class="container">
  <div class="container-fluid">
    <h4 class="text-center">Regional</h4>
    <div class="table-responsive">
    <table id="tbl_provinsi" class="table table-striped table-bordered" style="width:100%;font-size:12px;">
            <thead>
                <tr style="background-color:#b30000;color:#fff;">
                    <th>Province</th>
                    <th>Comfirmed</th>
                    <th>Deaths</th>
                    <th>Recovered</th>
                </tr>
            </thead>
            <tbody id="tabel_provinsi">
            </tbody>
            <tfoot>
                <tr>
                    <th>Province</th>
                    <th>Comfirmed</th>
                    <th>Deaths</th>
                    <th>Recovered</th>
                </tr>
            </tfoot>
        </table>
      </div>
  </div>
</div>
<br>
<div class="container">
  <div class="container-fluid">
    <h4 class="text-center">Sub-District Category</h4>
    <div class="table-responsive">
    <table id="tbl_kecamatan" class="table table-striped table-bordered" style="width:100%;font-size:10px;">
            <thead>
                <tr style="background-color:#000066;color:#fff;">
                    <th>Sub-District</th>
                    <th>District</th>
                    <th>Province</th>
                    <th>Category</th>
                </tr>
            </thead>
            <tbody id="tabel_kecamatan">
            </tbody>
            <tfoot>
                <tr>
                    <th>Sub-District</th>
                    <th>District</th>
                    <th>Province</th>
                    <th>Category</th>
                </tr>
            </tfoot>
        </table>
      </div>
  </div>
</div>
<br>
<div class="container">
  <div class="container-fluid">
  <br>
    <h4 class="card-title text-center">Timeline</h4>
    <br>
    <div class="row">
        <div class="col-md-12">
            <div class="main-timeline4">
                <div id="timeline"></div>
            </div>
        </div>
    </div>
  </div>
</div>


<!-- Footer -->
<footer class="footer">
  <div class="container">
    <div class="copyright">
          &copy; Copyright 2020 <strong>Kamil Anindita</strong>.
        </div>
        <div class="credits">
          Designed with <strong><i class="fa fa-heart" style="color:red"></i></strong></a>
        </div>
  </div>
</footer>
<br>
<br>
<br>
<br>

<script src="/js/jquery-3.4.1.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/series-label.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>

<script  type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script  type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
<script  type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>


<script>
$(document).ready(function(){

  $.get("https://services5.arcgis.com/VS6HdKS0VfIhv8Ct/arcgis/rest/services/Statistik_Perkembangan_COVID19_Indonesia/FeatureServer/0/query?where=1%3D1&objectIds=&time=&resultType=none&outFields=*&returnIdsOnly=false&returnUniqueIdsOnly=false&returnCountOnly=false&returnDistinctValues=false&cacheHint=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&having=&resultOffset=&resultRecordCount=&sqlFormat=none&f=pjson&token=", function(data){
    var obj = JSON.parse(data);
    //paling Tertinggi
    var jml_baru_per_hari=[]
    var jml_meni_per_hari=[]
    var jml_semb_per_hari=[]
    var hari=[]
    var resultDataTimeline=''
    var arr=[]
    $.each(obj.features, function(key, items){
      if (items.attributes.Jumlah_Kasus_Kumulatif !=null) {
        var ts = new Date(items.attributes.Tanggal);
        jml_baru_per_hari.push(items.attributes.Jumlah_Kasus_Baru_per_Hari)
        jml_meni_per_hari.push(items.attributes.Jumlah_Kasus_Meninggal_per_Hari)
        jml_semb_per_hari.push(items.attributes.Jumlah_Kasus_Sembuh_per_Hari)
        hari.push(ts.toDateString())

        resultDataTimeline ="<div class='timeline'>"
            +"<span class='timeline-icon'></span>"
            +"<span class='year'>" + ts.toDateString() + "</span>"
            +"<div class='timeline-content'>"
            +"<p class='description'>"
            +"NewConfirmed   : " + items.attributes.Jumlah_Kasus_Baru_per_Hari +"<br>"
            +"TotalConfirmed   : " + items.attributes.Jumlah_Kasus_Kumulatif +"<br>"
            +"NewDeaths      : " + items.attributes.Jumlah_Kasus_Meninggal_per_Hari +"<br>"
            +"TotalDeaths      : " + items.attributes.Jumlah_Pasien_Meninggal +"<br>"
            +"NewRecovered   : " + items.attributes.Jumlah_Kasus_Sembuh_per_Hari +"<br>"
            +"TotalRecovered   : " + items.attributes.Jumlah_Pasien_Sembuh +"</p>"
            "</div></div>";
        arr.push(resultDataTimeline)
      }
    })

    var positifMax=Math.max(...jml_baru_per_hari)
    var indexPos = jml_baru_per_hari.indexOf(positifMax);

    var meninggalMax=Math.max(...jml_meni_per_hari)
    var indexMen = jml_meni_per_hari.indexOf(meninggalMax);

    var sembuhMax=Math.max(...jml_semb_per_hari)
    var indexSem = jml_semb_per_hari.indexOf(sembuhMax);

    var postPositif ="<div class='text-center'>"
                    +"<p><strong>"
                    + hari[indexPos] +"<br>"
                    + "<h2>"+ positifMax +"</h2> "
                    + "</strong></p>"
                    "</div>";

    var postMeninggal ="<div class='text-center'>"
                    +"<p><strong>"
                    + hari[indexMen] +"<br>"
                    + "<h2>"+ meninggalMax +"</h2> "
                    + "</strong></p>"
                    "</div>";

    var postSembuh ="<div class='text-center'>"
                    +"<p><strong>"
                    + hari[indexSem] +"<br>"
                    + "<h2>"+ sembuhMax +"</h2> "
                    + "</strong></p>"
                    "</div>";

    $('#confirmed').html(postPositif)
    $('#meninggal').html(postMeninggal)
    $('#sembuh').html(postSembuh)
    arr.reverse()
    $('#timeline').html(arr)

    Highcharts.chart('container', {

      title: {
          text: 'Statistics of Coronavirus Cases'
      },

      subtitle: {
          text: 'Source: covid19.go.id.'
      },
      xAxis: {
          categories: hari
      },
      legend: {
          layout: 'vertical',
          align: 'right',
          verticalAlign: 'middle'
      },
      credits: {
          enabled: false
      },
      series: [{
          name: 'Confirmed',
          data: jml_baru_per_hari,
      },{
          name: 'Deaths',
          data: jml_meni_per_hari,
      },{
          name: 'Recovered',
          data: jml_semb_per_hari,
      }
    ],

      responsive: {
          rules: [{
              condition: {
                  maxWidth: 500
              },
              chartOptions: {
                  legend: {
                      layout: 'horizontal',
                      align: 'center',
                      verticalAlign: 'bottom'
                  }
              }
          }]
      }

    });

  })

//Regional
  $.get("https://services5.arcgis.com/VS6HdKS0VfIhv8Ct/arcgis/rest/services/COVID19_Indonesia_per_Provinsi/FeatureServer/0/query?where=1%3D1&outFields=*&outSR=4326&f=json", function(data){
    var obj = JSON.parse(data);
    var dataProvinsiResults=''
    $.each(obj.features, function(key, items){
      dataProvinsiResults +=
                    "<tr>"
                    +"<td>" + items.attributes.Provinsi +"</td>"
                    +"<td>" + items.attributes.Kasus_Posi +"</td>"
                    +"<td>" + items.attributes.Kasus_Meni +"</td>"
                    +"<td>" + items.attributes.Kasus_Semb +"</td>"
                    "</tr>";
    })
    $('#tabel_provinsi').html(dataProvinsiResults)
    $('#tbl_provinsi').DataTable();
  })

  //kecamatan
    $.get("https://services5.arcgis.com/VS6HdKS0VfIhv8Ct/arcgis/rest/services/Kecamatan_Rawan_COVID19/FeatureServer/1/query?where=1%3D1&objectIds=&time=&resultType=none&outFields=*&returnIdsOnly=false&returnUniqueIdsOnly=false&returnCountOnly=false&returnDistinctValues=false&cacheHint=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&having=&resultOffset=&resultRecordCount=&sqlFormat=none&f=pjson&token=", function(data){
      var obj = JSON.parse(data);
      var dataKecamatanResults=''
      $.each(obj.features, function(key, items){
        dataKecamatanResults +=
                      "<tr>"
                      +"<td>" + items.attributes.kecamatan +"</td>"
                      +"<td>" + items.attributes.kabupaten +"</td>"
                      +"<td>" + items.attributes.provinsi +"</td>"
                      +"<td><strong>" + items.attributes.kategori +"</strong></td>"
                      "</tr>";
      })
      $('#tabel_kecamatan').html(dataKecamatanResults)
      $('#tbl_kecamatan').DataTable();
    })


})
</script>


</body>
</html>
